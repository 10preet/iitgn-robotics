import math
import scipy
import sympy as sp
from sympy.core.evalf import N
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.animation as animation
from mpl_toolkits.mplot3d import Axes3D 
from scipy.integrate import solve_ivp, ode
from scipy.optimize import fsolve

xs_d=[0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4000000000000001, 0.39999999999999997, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.4000000000000001, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4000000000000001, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.39999999999999997, 0.39999999999999997, 0.4, 0.4, 0.4, 0.39999999999999997, 0.39999999999999997, 0.39999999999999997, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4000000000000001, 0.4, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4000000000000001, 0.39999999999999997, 0.4000000000000001, 0.39999999999999997, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.39999999999999997, 0.4000000000000001, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4000000000000001, 0.4, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.39999999999999997, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.4, 0.39999999999999997, 0.4, 0.4, 0.39999999999999997, 0.39999999999999997, 0.4000000000000001, 0.4, 
0.4, 0.4, 0.4, 0.4]
ys_d=[0.06, 0.06000235109156249, 0.06000881743, 0.060018538062187494, 0.06003067775999999, 0.06004442675781249, 0.06005900049, 0.060073639328437484, 0.06008760831999998, 0.06010019692406248, 0.06011071874999998, 0.06011851129468749, 0.06012293567999999, 0.06012337639031248, 0.060119241009999984, 0.060109959960937494, 0.06009498623999998, 0.060073795156562484, 0.06004588406999998, 0.06001077212718749, 0.05996799999999997, 0.05991712962281248, 0.059857743929999985, 0.05978944659343747, 0.059711861759999985, 0.05962463378906248, 0.059527426989999965, 0.05941992535968746, 0.05930183231999998, 0.059172870455312464, 0.05903278124999997, 0.05888132482593747, 0.05871827967999998, 0.058543442421562474, 0.058356627509999974, 0.05815766699218747, 0.05794641023999996, 0.05772272368781245, 0.05748649056999994, 0.05723761065843745, 0.05697599999999995, 0.05670159065406245, 0.056414330429999965, 0.05611418262468745, 0.05580112575999996, 0.05547515332031244, 0.055136273489999936, 0.05478450889093745, 0.05441989631999996, 0.054042486486562444, 0.05365234374999994, 0.05324954585718745, 0.05283418367999993, 0.052406360952812446, 0.05196619400999993, 0.05151381152343744, 0.051049354239999935, 0.05057297471906244, 0.05008483706999994, 0.04958511668968743, 0.04907399999999992, 0.04855168418531244, 0.04801837692999994, 0.047474296155937436, 0.04691966975999993, 0.04635473535156243, 0.04577973998999993, 0.04519493992218742, 0.04460060031999992, 0.04399699501781243, 0.04338440624999993, 0.04276312438843743, 0.042133447679999915, 0.04149568198406242, 0.04085014050999992, 0.04019714355468742, 0.039537018239999895, 0.03887009825031241, 0.03819672356999991, 0.037517240220937415, 0.0368319999999999, 0.03614136021656241, 0.03544568342999992, 0.03474533718718739, 0.03404069375999991, 0.0333321298828124, 0.03262002648999989, 0.031904768453437406, 0.031186744319999904, 0.030466346049062384, 0.029743968749999888, 0.029020010419687388, 0.028294871679999875, 0.0275689555153124, 0.02684266700999988, 0.02611641308593742, 0.025390602239999914, 0.024665644281562402, 0.023941950069999884, 0.023219931252187354, 0.02249999999999988, 0.021782568747812352, 0.02106804992999985, 0.020356855718437393, 0.019649397759999906, 0.018946086914062375, 0.018247332989999906, 0.017553544484687378, 0.01686512831999987, 0.016182489580312397, 0.015506031249999865, 0.014836153950937373, 0.014173255679999885, 0.013517731546562406, 0.012869973509999924, 0.012230370117187347, 0.011599306239999871, 0.010977162812812392, 0.010364316569999851, 
0.009761139783437414, 0.009167999999999898, 0.008585259779062368, 0.008013276429999848, 0.007452401749687352, 0.006902981759999872, 0.006365356445312332, 0.005839859489999891, 0.00532681801593736, 0.004826552319999788, 0.004339375611562363, 0.0038655937499999103, 0.0034055049821874323, 0.0029593996799998495, 0.002527560077812324, 0.0021102600099999064, 0.0017077646484373874, 0.0013203302399999034, 0.0009482038440623286, 0.0005916230699998387, 0.00025081581468733294, -7.400000000007399e-05, -0.0003826166896876982, -0.0006748370700001005, -0.0009504747190626496, -0.0012093542400001542, -0.0014513115234377207, -0.0016761940100000758, -0.0018838609528126211, -0.0020741836800001467, -0.0022470458571876295, -0.002402343750000174, -0.0025399864865625343, -0.002659896320000271, -0.0027620088909375558, -0.002846273490000134, -0.0029126533203126526, -0.0029611257600001277, -0.0029916826246875194, -0.003004330430000034, -0.002999090654062592, -0.0029760000000002285, -0.002935110658437767, -0.0028764905700001397, -0.0028002236878126303, -0.0027064102400001793, -0.0025951669921877585, -0.0024666275100001527, -0.0023209424215626666, -0.002158279679999986, -0.0019788248259376418, 
-0.0017827812500001428, -0.0015703704553124977, -0.0013418323200001248, -0.0010974253596875427, -0.000837426990000112, -0.0005621337890627243, -0.0002718617600001027, 3.305340656239997e-05, 0.00035225606999977893, 0.0006853703771872998, 0.0010319999999997553, 0.0013917278728123312, 0.0017641159299998654, 0.002148704843437488, 0.002545013759999715, 0.0029525400390624785, 0.00337075899, 0.0037991236096873715, 0.004237064319999818, 0.00468398870531239, 0.005139281250000072, 0.005602303075937566, 0.006072391680000066, 0.006548860671562461, 0.007030999509999858, 0.007518073242187562, 0.008009322239999951, 0.008503961937812554, 0.0090011825699996, 0.009500148908437535]

xs_contd=[0.3997299823560302, 0.3846855043459185, 0.3084248737324997, 0.2526786963479225, 0.21531851148594913, 0.2056636461153051, 0.2001892425281948, 0.19598577557705263, 0.19266804152530206, 0.1898551282923407, 0.18756694305593807, 0.18580609040548676, 0.18427948035913538, 0.18306585322752558, 0.18211588393167302, 0.18136340501096027, 0.1806816421383904, 0.18009491475618614, 0.17970917870294542, 0.17940367654852568, 0.17913375879701904, 0.17888163648908148, 0.17873904059535473, 0.17868024585431067, 0.17863458879992222, 0.17847728581033398, 0.17840729619864157, 0.1783321039448878, 0.1782602212944474, 0.17813705017675008, 0.1779891858669614, 0.177891375145246, 0.17782205829919726, 0.1777394884419794, 0.17769477508351464, 0.1776575065373295, 0.17762796805512684, 0.17760919806815106, 0.17758910616669144, 0.17755515137722688, 0.17749364759513986, 0.17745079769912567, 0.17741481039792867, 0.17739750274713778, 0.1773730409029169, 0.17736372697406272, 0.17735780711558538, 0.17734383989670352, 0.17733059002883272, 0.1773003566385331, 0.17728041243685086, 0.17727022235504597, 0.17723766740058064, 0.17719140788848098, 0.17714713267508764, 0.17709344502066568, 0.17704790673405763, 0.1770037284462868, 0.1769640843055707, 0.17693646838818983, 0.17686860742093757, 0.17680844117723998, 0.1767253051062021, 0.17669360801105716, 0.1766705157317899, 0.17663335300473154, 0.17658607180518063, 0.1765611858196074, 0.1765302257944532, 0.17648150974145035, 0.1764012225949974, 0.176361410566452, 0.1763302825939335, 0.17630277418587637, 0.1762594642344037, 0.1762049440175816, 0.17616491339583262, 0.17610061101501318, 0.1760331220360753, 0.1759793098054342, 0.17590675137275388, 0.17585664254763603, 0.1758144865973344, 0.17577705122100248, 0.17574907946052584, 0.17571453909678056, 0.17568196608641448, 0.1756479919552426, 0.1756006326815888, 0.17554648873282325, 0.175492759478184, 0.17540500001076506, 0.17532294255515615, 0.17525859875942126, 0.1751925151058331, 0.1751404562288611, 0.1750824282168301, 0.1750233303829321, 0.17494315932661286, 0.17487612349992532, 0.1748225796719358, 0.17479981695971394, 0.17477576661888994, 0.1747440272040565, 0.17471161021980836, 0.17468409518044214, 0.17466683463188853, 0.17465504534661783, 0.17462549391329205, 0.1745864121260015, 0.17452175192850616, 0.17444689170388275, 0.17439301996119128, 0.174323514393211, 0.17429373102465495, 0.1742635329044752, 0.17422727727536966, 0.17414747214179363, 0.17409631192094754, 0.1740586036103615, 0.17403627363936153, 0.1740072393837619, 0.17394503891172902, 0.17392040047744584, 0.17389738527886636, 0.1738667526774518, 0.17383998847575063, 0.17382430577327895, 0.1738106396548805, 0.17378957371162787, 0.1737675867287812, 0.17375479021532353, 0.17372072045918946, 0.17370530456101552, 0.17369482901950198, 0.17368893151142437, 0.17367755922959197, 0.17366553901515536, 0.1736535979517094, 0.17363883895759877, 0.17362382155291398, 0.17361592935398337, 0.17361440924712904, 0.1736062632614796, 0.17359016781738046, 0.1735608627642801, 0.17354706289781185, 0.17354335284533, 0.17354158537530903, 0.17353823843435726, 0.17353565556358794, 0.1735333635407969, 0.17353142232829985, 0.17352991252494385, 0.17352862967833127, 0.17352748096568776, 0.17352695868415427, 0.17352508004934458, 0.1735227452860553, 0.1735225875776305, 0.17352320155926976, 0.17352211460202518, 0.1735216951196242, 0.1735220266391952, 0.1735222514728234, 0.17352336872698845, 0.1735241043612616, 0.17352593511481013, 0.17352557985446876, 0.17352454840043827, 0.17352371732113578, 0.1735233412056362, 0.173521960885667, 0.17351989866718748, 0.17351900607145998, 0.17351835073682398, 0.17351827722914523, 0.1735184570609239, 0.17351890077487434, 0.17351918067396668, 0.1735197815860092, 0.1735211123445501, 0.17352556971081193, 0.17353025638772915, 0.17353497923266265, 0.17353979119172214, 0.17354391338382832, 0.17354799368925003, 0.17355102398820949, 0.1735557078988766, 0.173559639509081, 0.17356218271526302, 0.17356274754754777, 0.17356484378545567, 0.17356765977203492, 0.17357146845821253, 0.1735789967728731, 0.17358850911668106, 0.17360214336929403, 0.1736189898977403]
ys_contd=[0.06004220520578913, 0.06214784169594884, 0.06630019290606166, 0.0639329698754193, 0.06006035081410742, 0.05869995684471661, 0.05790568576831841, 0.057281558320730654, 0.05678602464748896, 0.05637584467212799, 0.056055954644989824, 0.0558011576754776, 0.05555842129515882, 0.05536170430241073, 0.0552022449369299, 0.05506517395980135, 0.05493778629756674, 0.05482918227178801, 0.054755092767170804, 0.05469099726974046, 0.05463747772202808, 0.05459101913402654, 0.05455924383741682, 0.054542884905946616, 0.054527926519794184, 0.054474874042188016, 0.0544496900168155, 0.054415309540363964, 
0.05436866537092738, 0.05425201055490885, 0.05405759143621831, 0.05387561368278589, 0.053682277903522035, 0.05344015431862577, 0.053283066619365584, 0.05309989237025123, 0.052932950862054746, 0.052669038190888494, 0.052444796853511194, 0.05223126396327315, 0.05190280134654595, 0.051702982070815855, 0.05149637809400112, 0.05133723720431202, 0.051065051025177194, 0.05079815569628241, 0.050554034179106755, 0.0501597173978099, 0.04987426126443368, 0.049443427071837825, 0.04896086060759657, 0.04867057524033222, 0.04830048343890052, 0.04781222476097923, 0.047373329360196434, 0.04693814747885129, 0.04653256097251634, 0.0461930084668627, 0.04581459017845326, 0.045522702197383476, 0.04498026500687576, 0.04446324210778424, 0.04359216045040511, 0.04316656223121372, 0.042823861556882635, 0.04242571125297964, 0.04184418789742822, 0.041253898648355436, 0.04045181336596971, 0.039867739322204936, 0.039225210875336605, 0.0388273964983025, 0.03828219323655605, 0.03782589999757622, 0.037328614745882484, 0.036694949513645464, 0.03630840462197671, 0.035825881791497836, 0.035134935300160944, 0.03459429926709741, 0.03395230822819957, 0.03331255408743345, 0.03267663593940043, 0.03201649998197114, 0.031489403485444045, 0.03087298579302061, 0.030418286646193237, 0.029990647719674243, 0.029403882929145475, 0.028706155372816393, 0.02800949624244206, 0.02710141643205462, 0.026365596217573756, 0.025860761538826483, 0.02520329857432442, 0.02462981325753123, 0.024006520505788918, 0.02342814452407946, 0.022667879173600903, 0.021904094191104995, 0.021204946142897405, 0.02069854463248701, 0.020190109420636936, 0.019593877262727922, 0.019012614161032452, 0.01855147397766882, 0.01801523171355966, 0.01742292665463615, 0.01668030381063714, 0.016171498279353644, 0.01547575701828218, 0.01467104449294078, 0.014084076734143738, 0.013312444586402437, 0.01289753546868342, 0.01243113201282907, 0.012007479350885872, 0.011146907144633561, 0.010653048695077666, 0.01024111451893427, 0.00991963015484654, 0.009549092428705627, 0.0087986672235147, 0.008377830723271425, 0.007898638033951697, 0.007429052457248917, 0.007024264714099715, 0.006702305506135148, 0.00636303841066345, 0.005939877271754993, 0.005506188826924155, 0.005233835720513529, 0.0046597795967948455, 0.004374607052567458, 0.004073937910931735, 0.0039006341685055507, 0.0036586358197513995, 0.003379978556343445, 0.003027026009081644, 0.0027322372236210364, 0.0024595071690272775, 0.0022434365708175097, 0.0021966707343317182, 0.002006630436063262, 0.0016979095621382472, 0.0012238200628403965, 0.0009514550178169545, 0.0007927767236513871, 0.0006587623785665732, 0.000449763201680514, 0.00028777332922521573, 0.00013918282096506474, 5.0046007386736406e-05, -2.5383681663182393e-05, -0.00012411703152518473, -0.0002518046844439205, -0.00037494963761538927, -0.000497528789620226, -0.0005945105970462826, -0.0007053334875761687, -0.0008392473646181052, -0.0009406730590424449, -0.0010035011341954715, -0.0010593678466278237, -0.001082560239644513, -0.001129260624969328, -0.0011465849805564513, -0.0012188689375871647, -0.0012534351786334802, -0.0012793859123820333, -0.0013019143450206329, -0.0013147229915639032, -0.0013295311589912528, -0.00133761488069463, -0.0013375797018310806, -0.0013302444989001458, -0.0013243462117542599, -0.0013077570112222747, -0.0012917305059380103, -0.0012817442622861052, -0.001256523547796664, -0.0012251837170728765, -0.001145688724068316, -0.0010362917571060098, -0.0009056940786853341, -0.0007467313601329339, -0.0005813613608096189, -0.0004273154595683695, -0.0003224113381953775, -0.00017683703493758386, -6.777223936599756e-05, -1.1376358974344119e-06, 1.3860128063780742e-05, 6.852454471116003e-05, 0.0001412286404303224, 0.00024015350133844393, 0.00044099315778422057, 0.0006791039325769001, 0.0009703204159478249, 0.001293229315012009]

xs_contc=[0.3999987857299683, 0.39999871791477665, 0.40003704122827194, 0.4000561164967048, 0.4000868761715422, 0.40009899349047, 0.4001049029543292, 0.4001042402543637, 0.40009824295991203, 0.40008735560698955, 0.40006860114099385, 0.39993652961308895, 0.39991167459818966, 0.3998916245325575, 0.3998813660034194, 0.3998792283126029, 0.3998781063333406, 0.39987826377285685, 0.3998787166159666, 0.3998795829549313, 0.3998815831922391, 0.3998826893781765, 0.39988745877891835, 0.3998883616892687, 0.39989075972729704, 0.3998922589417296, 0.3998980938644806, 0.3999060905552873, 0.3999096186299743, 0.39991213307142326, 0.39991610150253015, 0.3999214485428283, 0.39992799429531795, 0.3999385407440203, 0.399949187674473, 0.39996360105953144, 0.39998473117172856, 0.40001779278695787, 0.40005233410389074, 0.4000903590318767, 0.40012033908090333, 0.40014007154623, 0.4001428049276137, 0.40013786501059323, 0.4001150052523365, 0.40008880258546364, 0.40005947685181714, 0.4000133926445987, 0.39998818312298334, 0.3999783959025228, 0.39997349760307155, 0.3999787958287824, 0.3999912258647537, 0.400003147615242, 0.4000271615231632, 0.400038927081049, 0.40005499945144685, 0.4000851783930558, 0.40010811155236786, 0.40015038567853195, 0.40016405070673855, 0.4001546837511863, 0.4001469339405663, 0.4001494070313905, 0.4001457227269571, 0.4001405724214452, 0.40014186316932854, 0.40013883129949385, 0.40013845142346793, 0.40014335359060577, 0.4001394835712304, 0.40012069586818766, 0.40010003504709585, 0.40008642188960436, 0.40008289405668523, 0.40008631459032484, 0.4000854511531773, 0.4000878004276694, 0.4000951395228659, 0.4000990036838966, 0.40009643212863505, 0.40007841392360155, 0.40006572321546663, 0.400064621784278, 0.4000684399185696, 0.4000617849172939, 0.40004772351195067, 0.4000368399525883, 0.40002473666813537, 0.4000224933094253, 0.40002193403548914, 0.4000065513020734, 0.39998398267461227, 0.39998520333890014, 0.4000022824469469, 0.4000179142588025, 0.40004077851044917, 0.40005000787906975, 0.4000609053788882, 0.40006964643003223, 0.40007265172829354, 0.4000684577063839, 0.40005122901978546, 0.4000308547296503, 0.40001761941636493, 0.4000018994003421, 0.39998680394832387, 0.39997925639168025, 0.3999771896078862, 0.39996996897993786, 0.3999587014533254, 0.39995162442352794, 0.39994955111614594, 0.39994548107689304, 0.3999384839572886, 0.39992330920440394, 0.3999044741789601, 0.3998840124197207, 0.39987541457467113, 0.39986815391759334, 0.39985264737332044, 0.39984229415435696, 0.39984038667203575, 0.39984121927244165, 0.39984235286663367, 0.3998433391978419, 0.39984428041363895, 0.3998469691589322, 0.39984853693753913, 0.39985077842350064, 0.39985169404604304, 0.39984899407456037, 0.39984158054628566, 0.3998195192598918, 0.39980360088454303, 0.3997967247745936, 0.3997914904534847, 0.39978882111879693, 0.39978687001203356, 0.3997863151766362, 0.3997860135000184, 0.3997856235327694, 0.39978561657516176, 0.3997855466299437, 0.3997862538134086, 0.3997875898442452, 0.3997904190755779, 0.3997912346189538, 0.39979894970165786, 0.3998007228817077, 0.39980192183284297, 0.3998025802782482, 0.3998014777227341, 0.3998002735125365, 0.39979718612387366, 0.39979112918231213, 0.39978310862533956, 0.3997766742837156, 0.3997738611145859, 0.39976934901418637, 0.39976002052804144, 0.3997510692307055, 0.3997449410441015, 0.3997398748623648, 0.39973584256818745, 0.3997339473589832, 0.39973399751637667, 0.39973468082634117, 0.39973521477300666, 0.3997359130720288, 0.399736357812946, 0.3997370361291253, 0.3997379649194501, 0.39973889169726107, 0.3997393025893459, 0.399739405425341, 0.3997394773564717, 0.3997396566835197, 0.3997399606397647, 0.39974063497519213, 0.3997412546605885, 0.3997417473469806, 0.3997421427645047, 0.39974378053454784, 0.39974685974540436, 0.3997512566875747, 0.39975714213221186, 0.39976505163618936, 0.399774605000334, 0.3997812218982414, 0.39978663826498156, 0.3997916918150249, 0.39979528521807145, 0.39979670858312283, 0.3997995815944159, 0.39980406985375794, 0.3998124690904196, 0.39982218778748735, 0.399832672020398, 0.3998440008440026]
ys_contc=[0.06000206673076175, 0.05999915414117691, 0.05990398033141906, 0.059860764973558925, 0.05979143637127789, 0.059765302434023844, 0.05976551319540992, 0.05977081229973527, 0.05976882965226421, 0.059770326237491345, 0.059796189767331615, 0.06020208930426145, 0.060284491344509715, 0.060337245352870626, 0.06036638855342522, 0.06037715907622308, 0.06038454642984712, 0.060387327918757165, 0.06039024103808506, 0.06038999365469351, 0.060382994765671494, 0.06037686243922271, 0.06035026339565658, 0.060345737794806585, 0.0603325131535705, 0.060323592068971775, 0.06029056296064285, 0.0602447467366988, 0.06022290301894556, 0.06020689978169197, 0.06018167673347387, 0.060145497668402784, 0.06009668300569005, 0.06000819505642199, 0.05989847027353479, 0.05970904690389377, 0.059420212780371295, 0.059041943585277715, 0.05865419512253854, 0.05806940007952942, 0.05730134389360908, 0.056320801295912666, 0.055862723860532, 0.055435890352250584, 0.05496849982926915, 0.05468715038356018, 0.05452041970938318, 0.05435266999206385, 0.05422730463321938, 0.05412027962217635, 0.05391022251498033, 0.053750466714624044, 0.053555687965255894, 0.05339050297078673, 0.0530475462216912, 0.05283370882166649, 0.0524305961871229, 0.05181617367475102, 0.05130729068024194, 0.05003880188507886, 0.04928017871584422, 0.04829289219148318, 0.04758537605261517, 0.04705602175867441, 0.04667963924726826, 0.04624560010857026, 0.04580443434370062, 0.045341052454040395, 0.04479720489769472, 0.04428891484419541, 0.043884455531536186, 0.04284084944987052, 0.04151626509109408, 0.040878392994222475, 0.040438061623690166, 0.03995219080591359, 0.03942891023856611, 0.039020973372912666, 0.03854331496800022, 0.03792526459521341, 0.03746637683274394, 0.03655231710166006, 0.03599387101243195, 0.035427309706211885, 0.03486269252662322, 0.03408831238932168, 0.03312413140800227, 0.0321777557426948, 0.031089039007455525, 0.03050120015307514, 0.029912498282025142, 0.02930593412696153, 0.02848437925434579, 0.02791194824360644, 0.027274241413707045, 0.026847454775261216, 0.026282203052539206, 0.026028848833887938, 0.025585026775230744, 0.024939257793253195, 0.02419909478964687, 0.023044508939774465, 0.022025426528590727, 0.021228201239006317, 0.02049903400873771, 0.019412219503402935, 0.018614699603136615, 0.017843833249117796, 0.017155575188387562, 0.016591353004506718, 0.016030340052388566, 0.015582135984862824, 0.015107572814316543, 0.01435879986626199, 0.013883782246442416, 0.013273310250030618, 0.012687000584399848, 0.011953244280368194, 0.011375155899626144, 0.010921650309144841, 0.010314507243839947, 0.009813721447593371, 0.009435458408276644, 0.009322593268332078, 0.009205221076750226, 0.009105220448649058, 0.009004747046625676, 0.008695647079973674, 0.008413483780836962, 0.007986579347176226, 0.007684687990753297, 0.007073887104621272, 0.006422455137451544, 0.005232978664100855, 0.004304677603407749, 0.003603775531950261, 0.002823172874563082, 0.0024390536273685985, 0.00207762905812941, 0.001885394968959574, 0.0017765818811064753, 0.0015368337412800263, 0.001467106506415955, 0.0012662642671242151, 0.0009424941953099098, 0.0007445447053726992, 0.00043735073654532785, 0.00034953466357597073, -0.0005033012395609362, -0.000725894948904079, -0.0008993799493323448, -0.0012187550126155362, -0.0014126259482261717, -0.0015307773494994922, -0.00175917924140471, -0.002070415241192739, -0.0023174979616860172, -0.0024722148955881895, -0.0025459002395045584, -0.002697453458221214, -0.002915726909988337, -0.0030455689758787127, -0.0031368999856231632, -0.0032210503918902967, -0.0032766669584801487, -0.0033062734769349175, -0.0033127656567472925, -0.0033168650131304538, -0.003316714403259947, -0.0033138190416690107, -0.0033078950776444568, -0.0032941000232254553, -0.0032612926166516207, -0.003207037576622422, -0.0031574204374437424, -0.0031278203399143886, -0.003098077386727865, -0.003052884033022084, -0.0030119826815592343, -0.0029451349678392556, -0.0028934327584236234, -0.002851357502992768, -0.0028174793755219173, -0.002706273960440074, -0.0025193293352593596, -0.002270419743929179, -0.001999760110203896, -0.001678650219277875, -0.0012570144971019623, -0.0008829824610781623, -0.0005432690899050793, -0.00024158135016677222, -3.4204025420857964e-05, 4.617288439265867e-05, 0.00020584847652220495, 0.0004459877600288821, 0.0008627394801866112, 0.0013869397882115885, 0.0020604289537678997, 0.002818403078924055]

xs_contb=[0.399777560368569, 0.39895695629710826, 0.3974872005879594, 0.39658520710100825, 0.3958732899611982, 0.39562259062642574, 0.3955195654214779, 0.39530621921071507, 0.3952575436763961, 0.3952431986502848, 0.3952459183365564, 0.3952288413974842, 0.3951894272099558, 0.39515493395781154, 0.3951202052509139, 0.3950842792895796, 0.3950742126960395, 0.3950990230981416, 0.3951079679316142, 0.3950899355499201, 0.39505955854320224, 0.39504074858832294, 0.3950087225899696, 0.39499025373178015, 0.3949914435847017, 0.3949893137936941, 0.3949970527196931, 0.39503485660932997, 0.39498118594589515, 0.394938700105608, 0.3949594245255337, 0.3950033316338536, 0.3950990221912164, 0.3951379292845698, 0.3951091822283542, 0.3950788360996428, 0.3951090600147061, 0.39512201613471293, 0.3951499802296895, 0.3950933849474195, 0.39507005662991396, 0.39502492470632855, 0.39506501077851053, 0.39506321093477964, 0.39503637593948393, 0.39504645345641, 0.3950548886268138, 0.39510368307187993, 0.3951512802682223, 0.3951888169123129, 0.39517372620237495, 0.3951731724323013, 0.39518013641780664, 0.3951066762415012, 0.39505194530297233, 0.39505783673896616, 0.39514566747406527, 0.39518205554920355, 0.39520508250027303, 0.39527068375814567, 0.39527635715024056, 0.39527999134245057, 0.3952831684774657, 0.3952808685755899, 0.395272136106698, 0.39526200629916547, 0.3952569893111705, 0.3952544830450468, 0.395249821554242, 0.3952456912760926, 0.3952477578997879, 0.3952575247921625, 0.3952544602903573, 0.3952592924220989, 0.39527275473829593, 0.39527791804772644, 0.39527336019684306, 0.39526841774081883, 0.3952787424976709, 0.3953013618355362, 0.3953253107721648, 0.39533565992406045, 0.39533967714598134, 0.39534296458571166, 0.3953551317889175, 0.39538592141844764, 0.3954016948799083, 0.39540565364546865, 0.3953992322305718, 0.3953639483601477, 0.3953359746022727, 0.395314006153642, 0.39529569666198955, 0.3952990787102468, 0.395301986146307, 0.39529398801087584, 0.395288628294133, 0.3952941567389767, 0.3953062885309867, 0.3953096026459611, 0.39530689885641024, 0.39530410927753923, 0.3952874674887014, 0.3952519051816718, 0.39522516922238754, 0.3952140142289778, 0.3952011545994508, 0.39518365463771976, 0.3951470751071173, 0.3951233658029038, 0.39510479164402, 0.39509037985216283, 0.39508011733613263, 0.3950803568135212, 0.39508133871300855, 0.3950753558536755, 0.3950697031770081, 0.39506224902293086, 0.3950409806164229, 0.3950182503794152, 0.3949969775336037, 0.39498684603915374, 0.3949610088042446, 0.39493476640198233, 0.3948979503684507, 0.3948582873454528, 0.39481518926272313, 0.394786121267704, 0.39475973899539596, 0.39474164325283156, 0.39472323078783844, 0.39471398884463843, 0.3947068329794372, 0.39469985511332506, 0.39468891038606313, 0.39467395373382236, 0.39466430278633263, 0.39465211144189066, 0.39462675024077587, 0.39461631793462415, 0.3946119546203269, 0.39461031036494454, 0.3946089533457507, 0.3946027377680473, 0.39459331627550776, 0.39458553771262755, 0.39457513719511733, 0.39456638554377566, 0.39456140457440503, 0.3945602555311653, 0.3945544056984895, 0.39454552273296634, 0.3945304777143169, 0.3945155730676913, 0.3945117020530328, 0.39450109859042515, 0.39448916871516027, 0.39447596402059704, 0.3944644379557928, 0.3944490304420043, 0.39443475741950057, 0.39441421136738763, 0.394396406828514, 0.39438542169550644, 0.3943784467260388, 0.3943756829715603, 0.39437488216029365, 0.3943740912805747, 0.39437089424158994, 0.39436951138211834, 0.39436755388647415, 0.39436697215412986, 0.39436630642277115, 0.39436553947432385, 0.3943647591807013, 0.39436400678934885, 0.39436474427216545, 0.3943659595143816, 0.394366424243304, 0.394367536791443, 0.3943691228720352, 0.3943710212347392, 0.39437506850998927, 0.39438112270892084, 0.39438986839429574, 0.3943993264037605, 0.394408910337944, 0.39441784729623547, 0.39442655112099684, 0.39443264549377854, 0.3944347139235607, 0.3944389429746591, 0.394444753994774, 0.3944537378012483, 0.3944644235427941, 0.3944761571614917, 0.3944957312757934, 0.39451959843215867, 0.39454775069830195, 0.3946081081609613]
ys_contb=[0.05997802807624744, 0.05986695034471896, 0.059585969694915926, 0.05942076461531553, 0.05938977981673018, 0.05937596903357707, 0.05940353263484858, 0.05955105195783641, 0.059536143271387454, 0.05942285026399551, 0.05938452876611598, 0.05936142467799155, 0.05920064857239064, 0.05918062485155093, 0.05921952271226195, 0.05918716617715343, 0.059047274110383706, 0.059003183115204354, 0.05903237311787719, 0.059052892586923034, 0.059051737554406, 0.05896886413690582, 0.05890146444560406, 0.058959058000332326, 0.05896432717420585, 0.05897744401263685, 0.0589699214674959, 0.05871053698884724, 
0.05841960668644252, 0.05816054743329109, 0.058033005446669624, 0.05781794845285546, 0.057569224648533285, 0.05742412791422874, 0.05711131311300583, 0.05682548470942203, 0.05667827489412028, 0.05660645222958905, 0.05625163754321334, 0.05572314573793055, 0.055648249749903005, 0.055234048568770365, 0.05496793053555964, 0.054758541088646924, 0.05441330224758009, 0.05431232779604847, 0.05422584731763188, 0.053834689750744985, 0.05343676519551463, 0.05300628659271156, 0.0522866981980915, 0.05184445984482358, 0.051582937860527506, 0.05079240759961425, 0.050248890946562264, 0.050161218472408654, 0.049982174994213556, 0.04978044105596446, 0.048707699055728, 0.047535499596656025, 0.04740775457890531, 0.04731642282718262, 0.04722630494962059, 0.04709095067571376, 0.04690028775196158, 0.04668624531581852, 0.04646152914637234, 0.046171651402173754, 0.04572032547426417, 0.045297383255106925, 0.04490490819069763, 0.044301059090204424, 0.04381636274733592, 0.04323121661665769, 0.042685830896976626, 0.04196884799639835, 0.04110387684036704, 0.040277166033178095, 0.03950759683202164, 0.038782333065508885, 0.038196833199760034, 0.037765669744162955, 0.03731634022766339, 0.03688362728796139, 0.03630457442921766, 0.03539800031824467, 0.034589470246796955, 0.03380927780409275, 0.03315113740019504, 0.032113221237845685, 0.031356333405288705, 0.030681862618358195, 0.029851869968825242, 0.0292849193013587, 0.028759962790391946, 0.027793293387006618, 0.027261966265509377, 0.02679337990484839, 0.02629541119242431, 0.025734507179766223, 0.02491485585431338, 0.02427149356841533, 0.02345441945261284, 0.022574858851154848, 0.02188082489651778, 0.021269209204337836, 0.02044191583091675, 0.019908019371517788, 0.01898721416690908, 0.01817206998043131, 0.017418576564100667, 0.016891176421000104, 0.016401198624636095, 0.01597616407022218, 0.015708504983771052, 0.014999883961811438, 0.014107142296333886, 0.013542468339522273, 
0.012899372534327129, 0.012350234125084522, 0.011568973301278238, 0.011105287628121064, 0.0105868339281493, 0.010126536675190619, 0.009457652762817877, 0.008809170384921933, 0.00813010131691597, 0.0077052049530063295, 0.007213126570026872, 0.006696858658742067, 0.006110796984018887, 0.005720605048783485, 0.005252465579289422, 0.004947180775960559, 0.004638642157319195, 0.00421803142297666, 0.003914537042045665, 0.003581906958784638, 0.0028695842269514443, 0.00254182204506695, 0.0023406391207895297, 0.0022231862977468964, 0.0021572369758859995, 0.00200946282048931, 0.0017736495024072315, 0.001514140499353744, 0.001200776159838112, 0.0009353746113517491, 0.0007720328964790414, 0.0007322421732443051, 0.0005787841876414183, 0.00040748607515074254, 0.0001684580006756463, -2.3726356241832457e-05, -6.923902150478274e-05, -0.00021152463014173105, -0.00036192709321438977, -0.0004996744131146283, -0.0006270497670641851, -0.0007783067845420287, -0.0008852661467139516, -0.0010102730841253505, -0.0011055647626919607, -0.0011742200274818604, -0.0012429974724690203, -0.0012891699090391282, -0.0013145524767538329, -0.0013312515029963938, -0.0013570155622696612, -0.0013630169945500444, -0.0013677833614550597, -0.0013683044793734653, -0.0013681560389217319, -0.0013634661814480118, -0.001347629738584922, -0.0013178309454414908, -0.00127340056818813, -0.0012369000607606398, -0.0012238195272076975, -0.0011933069694283613, -0.0011521453734582691, -0.001107225662613773, -0.0010168835515127633, -0.000901042531698834, -0.0007429541244122572, -0.0005571691849775611, -0.0003779767835513395, -0.00023417736749729254, -0.00010292926712002334, -9.843446105371883e-06, 2.1434413462356066e-05, 8.485071137235481e-05, 0.00017279837454494266, 0.0003137393410399235, 0.0004861018295971686, 0.0006848973164955659, 0.0009979684208160052, 0.0013745602404396868, 0.001823973677983335, 0.0027519699234570057]

xs_conta=[0.39975309291063144, 0.39818581224171085, 0.3966707729981768, 0.3962196357029789, 0.3957188687942202, 0.3954273896294907, 0.3953066652905672, 0.3952084831904353, 0.3952015968463791, 0.39516276987313653, 0.3951400593190332, 0.395120060012835, 0.3951151578221662, 0.3950703200004593, 0.39505415040920067, 0.3950585366319658, 0.39505843469949253, 0.39506873285079636, 0.3950804640953306, 0.39507412869260294, 0.39506420183461116, 0.3950635114960197, 0.3950456079700266, 0.39503126807803984, 0.39502938691587, 0.3950422990946828, 0.39516262402190916, 0.3951540453987617, 0.39507438554072116, 0.39505177219974236, 0.39508896751711825, 0.39513086391672086, 0.3951912476170836, 0.39519469438438004, 0.3951221790997927, 0.39511479740824923, 0.39513646828213933, 0.3951306049896422, 0.3951598210397754, 0.3952037193881852, 0.3952254249988054, 0.3952411064768985, 0.3952516773783585, 0.39526197063862706, 0.3952208188017232, 0.3952057977955282, 0.3952705273349697, 0.3952440151123309, 0.39521671931326496, 0.3952006064231162, 0.39517305178810413, 0.39515664142803125, 0.3951912797748087, 0.3953257823000327, 0.39540047064780776, 0.395320125058176, 0.3952895833101825, 0.39526597687594467, 0.3952483641321035, 0.39523902160676905, 0.39523590667495606, 0.395241143148281, 0.3952506072170612, 0.3952555649295335, 0.3952570778958605, 0.395253049720729, 0.3952477623975161, 0.3952357651309579, 0.3952320974157397, 0.39524113215595175, 0.3952393279172212, 0.3952347951257391, 0.39524163593620054, 0.3952605990729125, 0.39528127486833836, 0.3953060436522926, 0.39533395366565965, 0.3953384363845675, 0.39533919135949547, 0.395349881501529, 0.3953554855693589, 0.3953522448174743, 0.39533748295331794, 0.3953178619093064, 0.395308810610601, 0.3953122651666782, 0.39531451195650547, 0.39531715324150873, 0.39531849518836354, 0.39531239493001913, 0.3953003897131287, 0.395304039103472, 0.3953196751010445, 0.39532607173913553, 0.39532257450939995, 0.3953143430612329, 0.3953070503890845, 0.39531434886935807, 0.3953298349722417, 0.3953272344610534, 0.3953020335581698, 0.3952758947370325, 0.3952643656889685, 0.39526219699715004, 0.3952676439116791, 0.3952778150325884, 0.3952939883336491, 0.3953032236221704, 0.39530948441301017, 0.3953194416872553, 0.395334340847613, 0.3953398274360604, 0.39533550066483875, 0.3953140843120745, 0.39529000178073426, 0.3952817390496693, 0.39526954542861853, 0.39524913148317375, 0.3952266810047167, 0.39521726583808026, 0.39520724013252323, 0.3952012067615237, 0.3951921115097569, 0.3951806974649279, 0.3951730845206403, 0.3951701254157956, 0.39516015174308045, 0.39515287971772284, 0.39514540916277885, 0.39514063277019373, 0.3951422145922402, 0.3951450465336495, 0.39514623467964033, 0.39514577471355744, 0.39514391930572607, 0.39514253203864347, 0.3951387034441851, 0.3951303821755118, 0.3951285943943494, 0.39512772783027983, 0.39512733874990236, 0.39512740798788115, 0.39512775528654687, 0.3951289987806133, 0.395130808918337, 0.3951307886145678, 0.3951307165917751, 0.3951325410948877, 0.3951361304876502, 0.39513649517886545, 0.3951365413884383, 0.39513650162474384, 0.395136518861865, 0.3951370466855655, 0.39513723934310235, 0.3951389486521995, 0.3951433891646385, 0.39514499109542583, 0.3951474687172395, 0.39514804398996123, 0.39514841238355153, 0.39514856762146916, 0.39514855867873844, 0.3951481714188073, 0.39514798610237395, 0.3951478698627044, 0.3951472700378781, 0.39514697196823545, 0.3951469096882914, 0.3951467083900189, 0.39514637672972763, 0.3951459399313157, 0.3951450453980729, 0.39514347313308557, 0.3951417982057213, 0.3951408655491072, 0.39514055053160657, 0.3951398659541741, 0.3951397135293188, 0.3951385788394848, 0.3951374139142233, 0.3951369762024696, 
0.39513715453613196, 0.3951375095887358, 0.395137861244177, 0.39513821961785706, 0.3951384055270836, 0.39513832010117406, 0.395137921422523, 0.39513693408417855, 0.39513546028844676, 0.3951335365972323, 0.3951320061090454, 0.39513118262046104, 0.39513043110070706, 0.39512938354925736, 0.39512804302210736, 0.39512499794058564, 0.39512176292782814, 0.39511787134783116]
ys_conta=[0.05995540458065583, 0.05965184216076148, 0.05922396267801353, 0.05909300120735698, 0.059148696582230494, 0.0592446223693455, 0.0592926732638338, 0.05934183085030413, 0.059368533762198944, 0.05945178277459638, 0.059425289574475675, 0.059408280426373694, 0.05940605716906609, 0.05941025829624059, 0.05945270259762324, 0.05946010513737456, 0.05944514952176423, 0.05938407069422273, 0.059373928372395454, 0.05942710536535569, 0.059434488270585825, 0.05943435495856575, 0.05944951010877918, 0.059441004118078594, 0.05937054175628882, 0.059258552749108344, 0.05901743158544934, 0.05871383452105643, 0.05854141966544056, 0.05838005969187968, 0.05838713179168298, 0.058330548873584194, 0.05817540641391654, 0.05794754455084604, 0.05767074716301196, 0.05757127710851165, 0.057287218130484534, 0.05710742291949622, 0.05693845155436166, 0.05683381957766028, 0.05669100478921442, 0.05627029254841876, 0.055876600053110966, 0.0552967892098657, 0.05504881295119475, 0.05444691433431264, 0.053975696902670456, 0.05371232501051721, 0.05351062737024758, 0.05315711773497617, 0.05292000776569892, 0.05263376006297533, 0.05230102391636003, 0.05161390544979162, 0.051051760651590644, 0.050463569581735826, 0.050183358149262274, 0.04992081395827053, 0.04972580227826816, 0.049540174657285434, 0.0492781884518761, 0.04904571774317005, 0.04878562030876553, 0.04858159539644665, 0.04829641132154518, 0.0479656103836558, 0.0474885352833804, 0.046881219542081506, 0.04633129660029785, 0.045458303583515144, 0.044749341292336736, 0.0443050373893504, 0.04375129172099133, 0.042991097109546045, 0.04237299089456251, 0.041775048951199885, 0.040871987074747984, 0.04027161002902719, 0.03972333566508899, 0.03927921898441445, 0.03894688017810757, 0.03841150695127353, 0.037367560788913914, 0.03673354655125397, 0.03626809859323363, 0.03565765959447087, 0.035071113901525786, 0.03417365257632122, 0.03353349891712009, 0.033090684546351355, 0.03228518567038833, 0.03161764438112238, 0.0308449883114021, 0.03017043883390979, 0.02952346011460815, 0.02890556732343269, 0.02807124891839894, 0.027242224968815346, 0.02602376170675978, 0.025558918669140836, 0.024915850877892522, 0.024265479678610778, 0.02358903294155492, 0.02298426548998524, 0.021998175884036658, 0.021358649795727998, 0.020710098738680828, 0.02024564093887828, 0.01969970672171682, 0.0190509534596469, 0.01820763530713414, 0.017722290064842668, 0.017099078082642154, 0.016437040292096968, 0.01574407462361643, 0.01524196542133522, 0.014406065504672527, 0.013681052203517926, 0.01278026179360786, 0.012261889956272538, 0.011684683465534355, 0.011311058275375898, 0.010840497046985843, 0.010208611370249995, 0.009715063406310169, 0.009449013633917085, 0.008871762361634311, 0.008530661813259819, 0.008136739541339245, 0.007744037853747226, 0.007335929188659475, 0.007002162989366691, 0.006713489732216054, 0.0063626874344805025, 0.005785932599244081, 0.005230823117356708, 0.004921623745932787, 0.004420146918081726, 0.004104898716158098, 0.0037424993286572996, 0.003436825469881839, 0.003368236038705972, 0.0032040056149206246, 0.003021706981834414, 0.0026793078282662005, 0.002497111648917568, 0.002370138013766791, 0.0021806815397070207, 0.0018374501716765831, 0.001623215984590568, 0.0015713169932520933, 0.0014856592957821627, 0.0013829020448309505, 0.0010330533570755158, 0.0008272294260053748, 0.0006387797630804832, 0.0003530763041385422, 0.0002490980998845227, 5.084634345465419e-05, -1.2363622930358895e-05, -7.2356035846699e-05, -0.00014844568882201858, -0.00018653237804934709, -0.00027808114056217465, -0.0003633910372651051, -0.0004312265755800512, -0.0005243943678282263, -0.0005958128166724962, -0.0006223076481689691, -0.000670390093547603, -0.000719012365788806, -0.0007747551062442068, -0.0008440946327387201, -0.0009245829503137442, -0.0009869028655538144, -0.0010292033926569872, -0.0010467125537816306, -0.0010530085150354848, -0.001052818058511997, -0.0010460663139160375, -0.0010197272318072767, -0.0009726620992621653, -0.0009150121416804694, -0.0008867681138345244, -0.0008603463066183251, -0.0008200620471795119, -0.0007226466029990078, -0.0006259716977954121, -0.0004927898280698155, -0.000351451328486016, -0.0002270497480644843, -0.00011181795206342096, -3.296410708029977e-05, 1.1282375464221742e-05, 5.5904128645667685e-05, 0.00013072034964707634, 0.00022278412788364358, 0.00039867286077883784, 0.000578017567658345, 0.0008756935591635081]

fig = plt.figure()
x=np.linspace(0,(2-0),(2-0)*100)
plt.plot(x,xs_d,c='black', label='Desired')
plt.plot(x,xs_conta,c='g', label='PD Control')
plt.plot(x,xs_contb,c='r', label='PD control with Feedforward')
plt.plot(x,xs_contc,c='blue', label='PD control with Computed torque' )
plt.plot(x,xs_contd,c='orange', label='Multivariable Control')

plt.legend()
plt.show()
